# Used for testing with both Jahia 8.2.0.0 and 8.2.2.0
- addMavenRepository: "https://devtools.jahia.com/nexus/content/repositories/jahia_staging_releases-2868"
  username: "NEXUS_USERNAME"
  password: "NEXUS_PASSWORD"

- addMavenRepository: "https://devtools.jahia.com/nexus/content/repositories/jahia_releases"
  username: "NEXUS_USERNAME"
  password: "NEXUS_PASSWORD"

# uninstall only if it exists, otherwise it throws an error
# need to hardcode version for uninstall
- if: org.jahia.osgi.BundleUtils.getBundleBySymbolicName('content-editor',null) != null
  do:
    - uninstallBundle: 'mvn:org.jahia.modules/content-editor/3.6.0'

- installBundle:
    - 'mvn:org.jahia.modules/jahia-page-composer/2.0.0'
    - 'mvn:org.jahia.modules/jahia-administration/1.11.0'
    - 'mvn:org.jahia.modules/graphql-dxm-provider/3.4.0'
    - 'mvn:org.jahia.modules/jahia-ui-root/1.10.0'
    - 'mvn:org.jahia.modules/jcontent/3.4.0'
    - 'mvn:org.jahia.test/jcontent-test-module/3.4.0'
    - 'mvn:org.jahia.test/jcontent-test-template/3.4.0'
  autoStart: true
  uninstallPreviousVersion: true

- include: 'provisioning.yml'
